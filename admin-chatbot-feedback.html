<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin - Chatbot Feedback & Support</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }

    h2 {
      color: #0a3d62;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 12px;
      border: 1px solid #ccc;
      text-align: left;
    }

    th {
      background: #0a3d62;
      color: #fff;
    }

    tr:hover {
      background: #f1f1f1;
    }

    .back-btn {
      display: inline-block;
      margin-bottom: 20px;
      padding: 10px 15px;
      background: #0a3d62;
      color: white;
      text-decoration: none;
      border-radius: 6px;
    }

    .no-data {
      text-align: center;
      padding: 30px;
      color: #999;
    }
  </style>
</head>
<body>

<a href="admin-dashboard.html" class="back-btn">‚Üê Back to Dashboard</a>
<h2>üì® Customer Feedback & Support Messages</h2>

<table id="supportTable">
  <thead>
    <tr>
      <th>Customer ID</th>
      <th>Name</th>
      <th>Type</th>
      <th>Message</th>
      <th>Date/Time</th>
    </tr>
  </thead>
  <tbody id="supportBody">
    <tr><td colspan="5" class="no-data">Loading messages...</td></tr>
  </tbody>
</table>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDLvrY6y3SyvLrX-yk8UcdO8RmnC89XNG4",
    authDomain: "jdms-207ba.firebaseapp.com",
    projectId: "jdms-207ba",
    storageBucket: "jdms-207ba.appspot.com",
    messagingSenderId: "449814553435",
    appId: "1:449814553435:web:008c7695473689f425307e"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const body = document.getElementById("supportBody");

  db.collection("supportMessages").orderBy("timestamp", "desc").onSnapshot(snapshot => {
    body.innerHTML = "";
    if (snapshot.empty) {
      body.innerHTML = '<tr><td colspan="5" class="no-data">No messages received yet.</td></tr>';
    } else {
      snapshot.forEach(doc => {
        const d = doc.data();
        const time = new Date(d.timestamp?.toDate?.() || Date.now()).toLocaleString();
        body.innerHTML += `
          <tr>
            <td>${d.customerId || 'N/A'}</td>
            <td>${d.customerName || 'N/A'}</td>
            <td>${d.messageType || 'General'}</td>
            <td>${d.messageText || ''}</td>
            <td>${time}</td>
          </tr>
        `;
      });
    }
  }, err => {
    body.innerHTML = `<tr><td colspan="5" class="no-data">‚ö†Ô∏è Error loading messages: ${err.message}</td></tr>`;
  });
</script>

</body>
</html>
