<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Help & Support - JDM Credit & Finance</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      font-family: 'Segoe UI', sans-serif;
    }
    .glass {
      background: rgba(255, 255, 255, 0.06);
      backdrop-filter: blur(10px);
      border-radius: 1rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
  </style>
</head>
<body class="min-h-screen p-6 text-white">

  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-6 text-center">üõ†Ô∏è Help & Support Center</h1>

    <!-- Chatbot Section -->
    <div class="glass p-4 mb-6">
      <h2 class="text-xl font-semibold mb-3">ü§ñ Chatbot Assistant</h2>
      <div id="chatLog" class="bg-white text-black p-3 rounded h-40 overflow-y-auto mb-3"></div>
      <input type="text" id="chatInput" placeholder="Type your question..." class="w-full px-4 py-2 rounded text-black" />
      <button onclick="handleChat()" class="mt-3 bg-blue-600 px-4 py-2 rounded hover:bg-blue-700">Send</button>
    </div>

    <!-- Ticket Section -->
    <div class="glass p-4 mb-6">
      <h2 class="text-xl font-semibold mb-3">üì© Raise a Ticket</h2>
      <input id="ticketSubject" placeholder="Subject" class="w-full mb-2 px-4 py-2 rounded text-black" />
      <select id="ticketCategory" class="w-full mb-2 px-4 py-2 rounded text-black">
        <option value="FD">FD</option>
        <option value="RD">RD</option>
        <option value="Account">Account</option>
        <option value="Complaint">Complaint</option>
        <option value="Other">Other</option>
      </select>
      <textarea id="ticketMessage" placeholder="Describe your issue..." rows="4" class="w-full px-4 py-2 rounded text-black"></textarea>
      <button onclick="submitTicket()" class="mt-3 bg-green-600 px-4 py-2 rounded hover:bg-green-700">Submit</button>
    </div>

    <!-- Ticket History -->
    <div class="glass p-4 mb-6">
      <h2 class="text-xl font-semibold mb-3">üïí Your Previous Tickets</h2>
      <ul id="ticketHistory" class="list-disc ml-6"></ul>
    </div>

    <!-- Contact Info -->
    <div class="glass p-4">
      <h2 class="text-xl font-semibold mb-3">üìû Contact Us</h2>
      <p>Email: support@jdmfinance.in</p>
      <p>Phone: +91-9876543210</p>
      <p>WhatsApp: <a href="https://wa.me/919876543210" class="text-blue-300 underline">Click to Chat</a></p>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDLvrY6y3SyvLrX-yk8UcdO8RmnC89XNG4",
      authDomain: "jdms-207ba.firebaseapp.com",
      projectId: "jdms-207ba",
      storageBucket: "jdms-207ba.appspot.com",
      messagingSenderId: "449814553435",
      appId: "1:449814553435:web:008c7695473689f425307e"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const customerId = localStorage.getItem("customerId") || "guest";

    function handleChat() {
      const input = document.getElementById("chatInput");
      const chatLog = document.getElementById("chatLog");
      const question = input.value.trim();
      if (!question) return;

      chatLog.innerHTML += `<div><strong>You:</strong> ${question}</div>`;

      let reply = "Thank you for your query. We will respond shortly.";
      if (question.toLowerCase().includes("fd")) reply = "You can open an FD by clicking the FD option on your dashboard.";
      if (question.toLowerCase().includes("interest")) reply = "Interest rates vary by customer type and duration.";

      chatLog.innerHTML += `<div><strong>Bot:</strong> ${reply}</div>`;
      input.value = "";
    }

    function submitTicket() {
      const subject = document.getElementById("ticketSubject").value;
      const category = document.getElementById("ticketCategory").value;
      const message = document.getElementById("ticketMessage").value;

      if (!subject || !category || !message) return alert("Please fill all fields");

      db.collection("support_tickets").add({
        customerId,
        subject,
        category,
        message,
        status: "Open",
        createdAt: new Date().toISOString()
      }).then(() => {
        alert("‚úÖ Ticket submitted successfully");
        loadTickets();
      });
    }

    function loadTickets() {
      const list = document.getElementById("ticketHistory");
      list.innerHTML = "";
      db.collection("support_tickets").where("customerId", "==", customerId).get().then(snapshot => {
        snapshot.forEach(doc => {
          const d = doc.data();
          list.innerHTML += `<li><strong>${d.subject}</strong> (${d.status}) - ${d.category}</li>`;
        });
      });
    }

    loadTickets();
  </script>

</body>
</html>
